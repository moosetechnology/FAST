"
Use me to generate the MetaModel of FAST

NOTE: I generate the Core FAST Model and the Java FAST Model because we can't currently do `resetMetadata` with extended metamodel generated by FamixNG
"
Class {
	#name : #FASTMetamodelGenerator,
	#superclass : #FamixBasicInfrastructureGenerator,
	#instVars : [
		'expression',
		'literal',
		'booleanLiteral',
		'characterLiteral',
		'nullPointerLiteral',
		'stringLiteral',
		'variableExpression',
		'scopableEntity',
		'behaviouralEntity',
		'statement',
		'expressionStatement',
		'returnStatement',
		'statementBlock',
		'variableEntity',
		'namedBehaviouralEntity'
	],
	#category : #'FAST-Model-Generator'
}

{ #category : #accessing }
FASTMetamodelGenerator class >> packageName [

	^ #'FAST-Core-Model'
]

{ #category : #accessing }
FASTMetamodelGenerator class >> prefix [
	^ #FAST
]

{ #category : #definition }
FASTMetamodelGenerator >> addTo: aRelation commentOnSide: aComment commentOnOppositeSide: anOtherComment [
	aRelation side comment: aComment.
	aRelation oppositeSide comment: anOtherComment
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForBehaviouralEntity [
	^ 'Represents a generic behavioural entity which has parameters and local variables, as well as statements. 

Can represent a SmalltalkBlock, or a JavaLambda
Subclassed for NamedBehavioural as methods/functions

Has parameters , and a body (StatementBlock).
Local variables are intended to be stored in the local entities of the body'
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForBooleanLiteral [
	^ 'A boolean literal'
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForCharacterLiteral [
	^ 'A character literal'
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForEntity [
	^ 'A FASTEntity is an abstract class for all FAST classes

Primarily introduced to deal with symbol resolution matters.'
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForExpression [
	^ 'An abstract superclass representing an expression node of a source code.'
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForExpressionStatement [
	^ 'A node of a statement which is representing a single expression. '
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForLiteral [
	^ 'A literal node.

Contains a value for the literal.

FLAG: should refactor some literals to core-model
    e.g.: character, int, float, string, boolean '
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForNamedBehaviouralEntity [
	^ '@FLAG: May be could be removed to have a simpler core model.
Each language would have to implement it correctly then

A behavioural entity that can be referenced with a name.

Assumed to correspond to a function or a method'
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForNullPointerLiteral [
	^ 'An undefined object literal'
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForReturnStatement [
	^ 'A return statement node. Contains a reference to the expression which is returned.  '
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForScopableEntity [
	^ 'A Entity with an optional scope

Statements are scopable because many statements allow to introduce local variables (e.g. for statement in Java)'
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForStatement [
	^ 'An abstract subclass which represents a source code statemnet '
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForStatementBlock [
	^ 'A block of statements as ones in C-like langs with {}'
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForStringLiteral [
	^ 'A string literal'
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForVariableEntity [
	^ 'A representation of a variable entity, '
]

{ #category : #definition }
FASTMetamodelGenerator >> commentForVariableExpression [
	^ 'A node that wraps around structural entity'
]

{ #category : #definition }
FASTMetamodelGenerator >> defineClasses [
	super defineClasses..
	expression := builder newClassNamed: #Expression comment: self commentForExpression.
	literal := builder newClassNamed: #Literal comment: self commentForLiteral.
	booleanLiteral := builder newClassNamed: #BooleanLiteral comment: self commentForBooleanLiteral.
	characterLiteral := builder newClassNamed: #CharacterLiteral comment: self commentForCharacterLiteral.
	nullPointerLiteral := builder newClassNamed: #NullPointerLiteral comment: self commentForNullPointerLiteral.
	stringLiteral := builder newClassNamed: #StringLiteral comment: self commentForStringLiteral.
	variableExpression := builder newClassNamed: #VariableExpression comment: self commentForVariableExpression.
	scopableEntity := builder newClassNamed: #ScopableEntity comment: self commentForScopableEntity.
	behaviouralEntity := builder newClassNamed: #BehaviouralEntity comment: self commentForBehaviouralEntity.
	namedBehaviouralEntity := builder newClassNamed: #NamedBehaviouralEntity comment: self commentForNamedBehaviouralEntity.
	statement := builder newClassNamed: #Statement comment: self commentForStatement.
	expressionStatement := builder newClassNamed: #ExpressionStatement comment: self commentForExpressionStatement.
	returnStatement := builder newClassNamed: #ReturnStatement comment: self commentForReturnStatement.
	statementBlock := builder newClassNamed: #StatementBlock comment: self commentForStatementBlock.
	variableEntity := builder newClassNamed: #VariableEntity comment: self commentForVariableEntity.
]

{ #category : #definition }
FASTMetamodelGenerator >> defineHierarchy [
	entity --|> #TEntityMetaLevelDependency.
	expression --|> entity.
	literal --|> expression.
	booleanLiteral --|> literal.
	characterLiteral --|> literal.
	nullPointerLiteral --|> literal.
	stringLiteral --|> literal.
	variableExpression --|> expression.
	scopableEntity --|> entity.
	behaviouralEntity --|> scopableEntity.
	namedBehaviouralEntity --|> behaviouralEntity.
	statement --|> scopableEntity.
	expressionStatement --|> statement.
	returnStatement --|> statement.
	statementBlock --|> statement.
	variableEntity --|> entity.

	"used to represent variable"
	namedEntity --|> entity.
	namedEntity --|> #TNamed.
	variableEntity --|> #TNamed.
	variableExpression --|> #TNamed.
	namedBehaviouralEntity --|> #TNamed.
	entity --|> #TDependencyQueries.
	entity --|> #TWithSourceAnchor
]

{ #category : #definition }
FASTMetamodelGenerator >> defineProperties [
	(literal property: #value type: #String) comment: 'The literal itself as found in the source code'
]

{ #category : #definition }
FASTMetamodelGenerator >> defineRelations [
	"in comment the old relation from the old FAST metamodel"

	((entity property: #parentNode) *-<> (entity property: #childrenNode))
		withNavigation

	"((expression property: #parentExpression) comment: 'Parent expression within which this expression appears (e.g. self=a+b and parent=2*(a+b)) ')
		-* ((expression property: #childrenExpressions) comment: 'Sub-expressions within this expression (e.g. self=2*(a+b) and child=a+b) ').
	((expression property: #parentStatement) comment: 'Parent statement containing this expression') - ((statement property: #childExpression) comment: 'Expression contained in this statement').
	((scopableEntity property: #localEntities) comment: 'Local entities (e.g. local variables) within the scope')
		-* ((entity property: #parentScopableEntity) comment: 'The parent entity of local entities (e.g. parent of a local variable)')."

	"((behaviouralEntity property: #parameters) comment: 'Parameters of the method') -* ((variableEntity property: #parentBehaviouralEntity)
		comment: 'A behavioual entity where this variable is defined as a parameter')."


	"((behaviouralEntity property: #statementBlock) comment: 'Statements block of the behavioural entity')
		- ((statementBlock property: #fastBehaviouralParent) comment: 'Behavioural entity containing the statement block.').
	((statement property: #statementContainer) comment: 'Block containing this statement.') *- ((statementBlock property: #statements) comment: 'Statements enclosed in this block')."
]

{ #category : #definition }
FASTMetamodelGenerator >> newBuilder [
	| standardBuilder mooseGenerator |
	^ self builderWithStandardTraits 
	
	"standardBuilder := FamixGenerator builderWithDefinitions.

	mooseGenerator := FamixMooseQueryGenerator new.
	mooseGenerator builder: standardBuilder.
	mooseGenerator adoptBuilder: standardBuilder.
	standardBuilder generator: mooseGenerator.
	mooseGenerator define.
	
	self adoptBuilder: standardBuilder.

	^ standardBuilder
		doNotGenerateCurrent;
		generator: self;
		yourself."
]
